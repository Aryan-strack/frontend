<div class="student-list">
  <!-- Header -->
  <div class="page-header mb-6">
    <div class="header-content">
      <h1>Student Management</h1>
      <p class="text-muted">Manage all students, view details, and perform actions.</p>
    </div>
    <div class="header-actions">
      <a routerLink="/students/new" class="btn btn-primary">
        <i class="fas fa-user-plus mr-2"></i> Add Student
      </a>
      <button class="btn btn-secondary" (click)="exportStudents()">
        <i class="fas fa-download mr-2"></i> Export
      </button>
    </div>
  </div>

  <!-- Filters -->
  <div class="filters-card mb-4">
    <div class="filters-header">
      <h3>Filters</h3>
      <button class="btn btn-link" (click)="onClearFilters()">Clear All</button>
    </div>
    
    <div class="filters-grid">
      <!-- Search Input -->
      <div class="filter-group">
        <label for="search">Search by Name</label>
        <div class="search-input">
          <i class="fas fa-search"></i>
          <input 
            type="text" 
            id="search" 
            [(ngModel)]="searchTerm"
            placeholder="Search students..."
            (keyup.enter)="onSearch()">
          <button class="btn btn-sm btn-primary" (click)="onSearch()">Search</button>
        </div>
      </div>

      <!-- Status Filter -->
      <div class="filter-group">
        <label for="status">Status</label>
        <select 
          id="status" 
          [(ngModel)]="selectedStatus"
          (change)="onSearch()"
          class="form-select">
          <option value="">All Status</option>
          <option value="Active">Active</option>
          <option value="Inactive">Inactive</option>
          <option value="Graduated">Graduated</option>
          <option value="Suspended">Suspended</option>
        </select>
      </div>

      <!-- Class Filter -->
      <div class="filter-group">
        <label for="class">Class</label>
        <select 
          id="class" 
          [(ngModel)]="selectedClass"
          (change)="onSearch()"
          class="form-select">
          <option value="">All Classes</option>
          <option *ngFor="let cls of classes" [value]="cls._id">
            {{ cls.className }} - {{ cls.section }}
          </option>
        </select>
      </div>

      <!-- Department Filter -->
      <div class="filter-group">
        <label for="department">Department</label>
        <select 
          id="department" 
          [(ngModel)]="selectedDepartment"
          (change)="onSearch()"
          class="form-select">
          <option value="">All Departments</option>
          <option *ngFor="let dept of departments" [value]="dept._id">
            {{ dept.departmentName }}
          </option>
        </select>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Loading students...</p>
  </div>

  <!-- Students Table -->
  <div *ngIf="!loading" class="table-container">
    <div class="table-responsive">
      <table class="data-table">
        <thead>
          <tr>
            <th>Roll No.</th>
            <th>Name</th>
            <th>Email</th>
            <th>Phone</th>
            <th>Class</th>
            <th>Department</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngIf="filteredStudents.length === 0">
            <td colspan="8" class="empty-state">
              <i class="fas fa-user-graduate"></i>
              <p>No students found. Try different filters or add new students.</p>
            </td>
          </tr>
          
          <tr *ngFor="let student of filteredStudents">
            <td>
              <strong>{{ student.rollNumber }}</strong>
            </td>
            <td>
              <div class="student-info">
                <div class="student-avatar">
                  <i class="fas fa-user-circle"></i>
                </div>
                <div class="student-details">
                  <div class="student-name">{{ student.name }}</div>
                  <div class="student-meta text-muted">
                    <i class="fas fa-venus-mars"></i> {{ student.gender }} | 
                    <i class="fas fa-birthday-cake"></i> {{ calculateAge(student.dateOfBirth) }} yrs
                  </div>
                </div>
              </div>
            </td>
            <td>{{ student.email }}</td>
            <td>{{ student.phone }}</td>
            <td>
              <span *ngIf="student.class" class="badge badge-light">
                {{ student.class.className }} - {{ student.class.section }}
              </span>
            </td>
            <td>
              <span *ngIf="student.department" class="badge badge-light">
                {{ student.department.departmentName }}
              </span>
            </td>
            <td>
              <span [class]="'badge ' + getStatusBadgeClass(student.status)">
                {{ student.status }}
              </span>
            </td>
            <td>
              <div class="action-buttons">
                <a [routerLink]="['/students', student._id]" 
                   class="btn btn-sm btn-info"
                   title="View Details">
                  <i class="fas fa-eye"></i>
                </a>
                <a [routerLink]="['/students', student._id, 'edit']" 
                   class="btn btn-sm btn-warning"
                   title="Edit">
                  <i class="fas fa-edit"></i>
                </a>
                <button (click)="onDeleteStudent(student._id!)"
                        class="btn btn-sm btn-danger"
                        title="Delete">
                  <i class="fas fa-trash"></i>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Pagination -->
    <div *ngIf="pagination.totalPages > 1" class="pagination">
      <div class="pagination-info">
        Showing {{ (pagination.currentPage - 1) * pagination.itemsPerPage + 1 }} to 
        {{ Math.min(pagination.currentPage * pagination.itemsPerPage, pagination.totalItems) }} 
        of {{ pagination.totalItems }} entries
      </div>
      
      <div class="pagination-controls">
        <button 
          class="btn btn-sm"
          [class.disabled]="!pagination.hasPrevPage"
          (click)="onPageChange(pagination.currentPage - 1)"
          [disabled]="!pagination.hasPrevPage">
          <i class="fas fa-chevron-left"></i> Previous
        </button>
        
        <div class="page-numbers">
          <button 
            *ngFor="let page of getPageNumbers()"
            class="btn btn-sm"
            [class.active]="page === pagination.currentPage"
            (click)="onPageChange(page)">
            {{ page }}
          </button>
        </div>
        
        <button 
          class="btn btn-sm"
          [class.disabled]="!pagination.hasNextPage"
          (click)="onPageChange(pagination.currentPage + 1)"
          [disabled]="!pagination.hasNextPage">
          Next <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>
  </div>
</div>