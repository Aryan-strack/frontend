<div class="student-details">
  <!-- Header -->
  <div class="page-header mb-6">
    <div class="header-content">
      <div class="breadcrumb">
        <a routerLink="/students" class="breadcrumb-link">Students</a>
        <span class="breadcrumb-separator">/</span>
        <span class="breadcrumb-current">Student Details</span>
      </div>
      <div class="student-header">
        <div class="student-avatar-large">
          <i class="fas fa-user-circle"></i>
        </div>
        <div class="student-info">
          <h1>{{ student?.name }}</h1>
          <div class="student-meta">
            <span class="badge" [class]="getStatusBadgeClass(student?.status || '')">
              {{ student?.status }}
            </span>
            <span class="meta-item">
              <i class="fas fa-id-card"></i> {{ student?.rollNumber }}
            </span>
            <span class="meta-item">
              <i class="fas fa-graduation-cap"></i> {{ student?.academicYear }}
            </span>
          </div>
        </div>
      </div>
    </div>
    
    <div class="header-actions">
      <a [routerLink]="['/students', student?._id, 'edit']" class="btn btn-warning">
        <i class="fas fa-edit mr-2"></i> Edit
      </a>
      <button class="btn btn-danger" (click)="onDelete()">
        <i class="fas fa-trash mr-2"></i> Delete
      </button>
      <a routerLink="/students" class="btn btn-secondary">
        <i class="fas fa-arrow-left mr-2"></i> Back
      </a>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Loading student details...</p>
  </div>

  <!-- Student Details -->
  <div *ngIf="!loading && student" class="details-container">
    <!-- Tabs -->
    <div class="tabs mb-6">
      <button class="tab-btn" [class.active]="activeTab === 'personal'" 
              (click)="setActiveTab('personal')">
        <i class="fas fa-user mr-2"></i> Personal
      </button>
      <button class="tab-btn" [class.active]="activeTab === 'academic'" 
              (click)="setActiveTab('academic')">
        <i class="fas fa-graduation-cap mr-2"></i> Academic
      </button>
      <button class="tab-btn" [class.active]="activeTab === 'courses'" 
              (click)="setActiveTab('courses')">
        <i class="fas fa-book mr-2"></i> Courses
      </button>
    </div>

    <!-- Personal Info Tab -->
    <div *ngIf="activeTab === 'personal'" class="tab-content">
      <div class="info-grid">
        <!-- Personal Details Card -->
        <div class="info-card">
          <div class="card-header">
            <h3><i class="fas fa-user-circle mr-2"></i> Personal Details</h3>
          </div>
          <div class="card-body">
            <div class="info-row">
              <span class="info-label">Full Name</span>
              <span class="info-value">{{ student.name }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Roll Number</span>
              <span class="info-value">{{ student.rollNumber }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Email</span>
              <span class="info-value">{{ student.email }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Phone</span>
              <span class="info-value">{{ student.phone }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Date of Birth</span>
              <span class="info-value">
                {{ student.dateOfBirth | date:'longDate' }} 
                ({{ calculateAge(student.dateOfBirth) }} years)
              </span>
            </div>
            <div class="info-row">
              <span class="info-label">Gender</span>
              <span class="info-value">{{ student.gender }}</span>
            </div>
          </div>
        </div>

        <!-- Address Card -->
        <div class="info-card">
          <div class="card-header">
            <h3><i class="fas fa-home mr-2"></i> Address</h3>
          </div>
          <div class="card-body">
            <div class="info-row">
              <span class="info-label">Street</span>
              <span class="info-value">{{ student.address.street }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">City</span>
              <span class="info-value">{{ student.address.city }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">State</span>
              <span class="info-value">{{ student.address.state }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Zip Code</span>
              <span class="info-value">{{ student.address.zipCode }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Country</span>
              <span class="info-value">{{ student.address.country || 'India' }}</span>
            </div>
          </div>
        </div>

        <!-- Guardian Info Card -->
        <div class="info-card">
          <div class="card-header">
            <h3><i class="fas fa-user-friends mr-2"></i> Guardian Information</h3>
          </div>
          <div class="card-body">
            <div class="info-row">
              <span class="info-label">Name</span>
              <span class="info-value">{{ student.guardianInfo.name }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Relationship</span>
              <span class="info-value">{{ student.guardianInfo.relationship }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Phone</span>
              <span class="info-value">{{ student.guardianInfo.phone }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Email</span>
              <span class="info-value">{{ student.guardianInfo.email || 'N/A' }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Academic Info Tab -->
    <div *ngIf="activeTab === 'academic'" class="tab-content">
      <div class="info-grid">
        <!-- Class Information -->
        <div class="info-card" *ngIf="student.class">
          <div class="card-header">
            <h3><i class="fas fa-chalkboard-teacher mr-2"></i> Class Information</h3>
          </div>
          <div class="card-body">
            <div class="info-row">
              <span class="info-label">Class</span>
              <span class="info-value">{{ student.class.className }} - {{ student.class.section }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Academic Year</span>
              <span class="info-value">{{ student.class.academicYear }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Class Teacher</span>
              <span class="info-value">{{ student.class.classTeacher?.name || 'N/A' }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Capacity</span>
              <span class="info-value">{{ student.class.currentStrength }}/{{ student.class.capacity }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Status</span>
              <span class="info-value">
                <span [class]="'badge ' + (student.class.status === 'Active' ? 'badge-success' : 'badge-warning')">
                  {{ student.class.status }}
                </span>
              </span>
            </div>
          </div>
        </div>

        <!-- Department Information -->
        <div class="info-card" *ngIf="student.department">
          <div class="card-header">
            <h3><i class="fas fa-building mr-2"></i> Department Information</h3>
          </div>
          <div class="card-body">
            <div class="info-row">
              <span class="info-label">Department</span>
              <span class="info-value">{{ student.department.departmentName }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Department Code</span>
              <span class="info-value">{{ student.department.departmentCode }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">HOD</span>
              <span class="info-value">{{ student.department.headOfDepartment?.name }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Contact Email</span>
              <span class="info-value">{{ student.department.contactEmail }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Contact Phone</span>
              <span class="info-value">{{ student.department.contactPhone }}</span>
            </div>
          </div>
        </div>

        <!-- Enrollment Details -->
        <div class="info-card">
          <div class="card-header">
            <h3><i class="fas fa-calendar-alt mr-2"></i> Enrollment Details</h3>
          </div>
          <div class="card-body">
            <div class="info-row">
              <span class="info-label">Enrollment Date</span>
              <span class="info-value">{{ student.enrollmentDate | date:'longDate' }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Academic Year</span>
              <span class="info-value">{{ student.academicYear }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Student Status</span>
              <span class="info-value">
                <span [class]="'badge ' + getStatusBadgeClass(student.status)">
                  {{ student.status }}
                </span>
              </span>
            </div>
            <div class="info-row">
              <span class="info-label">Last Updated</span>
              <span class="info-value">{{ student.updatedAt | date:'medium' }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Courses Tab -->
    <div *ngIf="activeTab === 'courses'" class="tab-content">
      <div class="courses-section">
        <div class="section-header mb-4">
          <h3>Enrolled Courses ({{ student.courses?.length || 0 }})</h3>
          <p class="text-muted">List of courses this student is currently enrolled in</p>
        </div>
        
        <div *ngIf="!student.courses || student.courses.length === 0" class="empty-state">
          <i class="fas fa-book"></i>
          <p>No courses enrolled</p>
          <a [routerLink]="['/students', student._id, 'edit']" class="btn btn-primary mt-3">
            <i class="fas fa-plus mr-2"></i> Enroll in Courses
          </a>
        </div>
        
        <div *ngIf="student.courses && student.courses.length > 0" class="courses-grid">
          <div *ngFor="let course of student.courses" class="course-card">
            <div class="course-header">
              <div class="course-code">{{ course.courseCode }}</div>
              <span class="badge" [class.badge-success]="course.courseType === 'Core'"
                              [class.badge-info]="course.courseType === 'Elective'">
                {{ course.courseType }}
              </span>
            </div>
            <div class="course-body">
              <h4>{{ course.courseName }}</h4>
              <div class="course-meta">
                <span><i class="fas fa-clock"></i> {{ course.creditHours }} Credits</span>
                <span><i class="fas fa-calendar"></i> {{ course.semester }} {{ course.year }}</span>
              </div>
              <p class="course-description">{{ course.description }}</p>
              <div class="course-instructor">
                <i class="fas fa-chalkboard-teacher"></i>
                <span>{{ course.instructor?.name || 'TBA' }}</span>
              </div>
            </div>
            <div class="course-footer">
              <div class="course-stats">
                <span><i class="fas fa-users"></i> {{ course.enrolledStudents }}/{{ course.maxStudents }}</span>
                <span><i class="fas fa-percentage"></i> {{ (course.enrolledStudents / course.maxStudents * 100).toFixed(0) }}%</span>
              </div>
              <a [routerLink]="['/courses', course._id]" class="btn btn-sm btn-info">
                View Details
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>